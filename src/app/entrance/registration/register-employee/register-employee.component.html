<app-header-top></app-header-top>
<h1>Регистрация как соискателя.</h1>
<form [formGroup]="myForm" novalidate (ngSubmit)="submit()">
  <div class="form-row">
    <div class="form-group col-md-2">
        <input type="text" class="form-control" id="userName" formControlName="userName" placeholder="Имя пользователя">
    </div>

    <div class="form-group col-md-3">

      <!-- Проверяем вносимый логин. Если логин уже есть в базе, показываем лейбл -Имя пользователя занято, или наоборот
    -->

    <div class="alert alert-danger"
         *ngIf="myForm.controls['userName'].touched && myForm.controls['userName'].value.length === 0 ">
      Не указано имя
    </div>

    <div *ngIf="myForm.controls['userName'].value.length > 0">
      <div *ngIf="myForm.controls['userName'].invalid; else trueUserNameTemplate">
        <div class="alert alert-danger">Имя пользователя занято</div>
      </div>

      <ng-template #trueUserNameTemplate>
        <div class="alert alert-info">Имя пользователя свободно</div>
      </ng-template>

  </div>
      <!-- закончили проверку логина -->
    </div>

  </div>

  <div class="form-row">
    <div class="form-group col-md-3">
      <label for="inputEmail">Email</label>
      <input type="email" class="form-control" id="inputEmail" placeholder="Email" formControlName="userEmail">
    </div>


<!-- начало обработки почтовых ошибок -->
    <div *ngIf="myForm.controls['userEmail'].dirty">

    <div class="alert alert-danger"
         *ngIf="myForm.controls['userEmail'].value.length === 0 ">
      Не указан Email.
    </div>

    <div *ngIf="myForm.controls['userEmail'].value.length > 0">
      <div *ngIf="myForm.controls['userEmail'].invalid; else trueSucc">

      <div class="alert alert-danger"
           *ngIf="myForm.controls['userEmail'].hasError('errorEmailExists') === true">
        Данный Email уже занят.
      </div>

      <div class="alert alert-danger"
           *ngIf="myForm.controls['userEmail'].hasError('email') === true">
        Неверно введен Email.
      </div>

    </div>
    <ng-template #trueSucc>
      <div class="alert alert-info">Email свободен.</div>
    </ng-template>
  </div>

</div>
<!-- закончили обработку почтовых ошибок -->


  </div>



  <div class="form-row">
    <div class="form-group col-md-3">
      <label for="inputPassword1">Пароль</label>
      <input type="password" class="form-control" id="inputPassword1" placeholder="Password" formControlName="userPassword1">

    </div>
  </div>

  <div class="form-group">
    <div class="form-check">
      <label class="form-check-label">
        <input class="form-check-input" type="checkbox" formControlName="cbLicense">
        Я согласен с правилами использования
      </label>
      <div class="alert alert-danger"
           *ngIf="myForm.controls['cbLicense'].invalid && myForm.controls['cbLicense'].touched">
        Согласитесь с лицензией
      </div>
      <br>

      <a class="nav-link" routerLink="/rules" routerLinkActive="active">Прочитать правила использования.</a>
    </div>
  </div>

  <button class="btn btn-primary" [disabled]="myForm.invalid">Зарегистрироваться</button>
</form>
